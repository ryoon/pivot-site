<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--
Licensed to the Apache Software Foundation (ASF) under one or more
contributor license agreements.  See the NOTICE file distributed with
this work for additional information regarding copyright ownership.
The ASF licenses this file to you under the Apache License,
Version 2.0 (the "License"); you may not use this file except in
compliance with the License.  You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
--><html xmlns="http://www.w3.org/1999/xhtml"><head><META http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>Data Binding | Apache Pivot</title><link href="/styles/pivot.css" rel="stylesheet" type="text/css" xmlns=""><link href="/styles/pivot_print.css" rel="stylesheet" type="text/css" media="print"><script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-7977275-3']);
                _gaq.push (['_gat._anonymizeIp']);
                _gaq.push(['_trackPageview']);
                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
                </script></head><body><div id="wrapper"><div id="main"><div id="header"><div class="logo"><a href="/index.html"><img src="/images/logo.png" alt="Apache Pivot" title="Apache Pivot Homepage"></a></div><div class="logoASF"><a href="http://www.apache.org/"><img src="/images/asf_logo_wide_transp.png" alt="Apache" title="Apache Homepage"></a></div><div class="tagline"><img src="/images/tagline.png" alt="Rich Internet Applications in Java" style="visibility:hidden"></div><ul class="navi"><li><a href="/demos/">Demos</a></li><li><a href="/download.cgi#2.1.0">Download</a></li><li><a href="/tutorials/">Tutorial</a></li><li><a href="/get-involved.html">Get Involved</a></li><li><a href="/about.html">About</a></li></ul></div><div id="contentBase" class="group"><h1>Data Binding</h1><ul class="naviLeft"><li><a href="/tutorials/sample-application.html">Sample Application</a></li><li><a href="/tutorials/platform-overview.html">Platform Overview</a></li><li><a href="/tutorials/hello-world.html">Hello, World!</a></li><li><a href="/tutorials/hello-bxml.html">Hello, BXML!</a></li><li><a href="/tutorials/component-and-container.html">Component &amp; Container</a></li><li><a href="/tutorials/labels-and-image-views.html">Labels &amp; Image Views</a></li><li><a href="/tutorials/svg-images.html">SVG Images</a></li><li><a href="/tutorials/buttons.html">Buttons</a></li><li><a href="/tutorials/push-buttons.html">Push Buttons</a></li><li><a href="/tutorials/toggle-buttons.html">Toggle Buttons</a></li><li><a href="/tutorials/radio-buttons.html">Radio Buttons</a></li><li><a href="/tutorials/checkboxes.html">Checkboxes</a></li><li><a href="/tutorials/link-buttons.html">Link Buttons</a></li><li><a href="/tutorials/lists.html">Lists</a></li><li><a href="/tutorials/list-buttons.html">List Buttons</a></li><li><a href="/tutorials/repeatable-list-buttons.html">Repeatable List Buttons</a></li><li><a href="/tutorials/text.html">Text</a></li><li><a href="/tutorials/suggestion-popups.html">Suggestion Popups</a></li><li><a href="/tutorials/text-areas.html">Text Areas</a></li><li><a href="/tutorials/separators.html">Separators</a></li><li><a href="/tutorials/layout-containers.html">Layout Containers</a></li><li><a href="/tutorials/flow-panes.html">Flow Panes</a></li><li><a href="/tutorials/box-panes.html">Box Panes</a></li><li><a href="/tutorials/fill-panes.html">Fill Panes</a></li><li><a href="/tutorials/grid-panes.html">Grid Panes</a></li><li><a href="/tutorials/table-panes.html">Table Panes</a></li><li><a href="/tutorials/borders.html">Borders</a></li><li><a href="/tutorials/stack-panes.html">Stack Panes</a></li><li><a href="/tutorials/split-panes.html">Split Panes</a></li><li><a href="/tutorials/forms.html">Forms</a></li><li><a href="/tutorials/panels.html">Panels</a></li><li><a href="/tutorials/navigation-containers.html">Navigation Containers</a></li><li><a href="/tutorials/card-panes.html">Card Panes</a></li><li><a href="/tutorials/tab-panes.html">Tab Panes</a></li><li><a href="/tutorials/accordions.html">Accordions</a></li><li><a href="/tutorials/expanders.html">Expanders</a></li><li><a href="/tutorials/rollups.html">Rollups</a></li><li><a href="/tutorials/viewports.html">Viewports</a></li><li><a href="/tutorials/scroll-panes.html">Scroll Panes</a></li><li><a href="/tutorials/panoramas.html">Panoramas</a></li><li><a href="/tutorials/progress-indicators.html">Progress Indicators</a></li><li><a href="/tutorials/meters.html">Meters</a></li><li><a href="/tutorials/activity-indicators.html">Activity Indicators</a></li><li><a href="/tutorials/bounded-range-components.html">Bounded Range Components</a></li><li><a href="/tutorials/sliders.html">Sliders</a></li><li><a href="/tutorials/scroll-bars.html">Scroll Bars</a></li><li><a href="/tutorials/spinners.html">Spinners</a></li><li><a href="/tutorials/calendars.html">Calendars</a></li><li><a href="/tutorials/menus.html">Menus</a></li><li><a href="/tutorials/context-menus.html">Context Menus</a></li><li><a href="/tutorials/menu-bars.html">Menu Bars</a></li><li><a href="/tutorials/menu-buttons.html">Menu Buttons</a></li><li><a href="/tutorials/color-choosers.html">Color Choosers</a></li><li><a href="/tutorials/table-views.html">Table Views</a></li><li><a href="/tutorials/table-views.json.html">JSON-based TableView</a></li><li><a href="/tutorials/table-views.custom.html">Custom TableView</a></li><li><a href="/tutorials/tree-views.html">Tree Views</a></li><li><a href="/tutorials/file-browsing.html">File Browsing</a></li><li><a href="/tutorials/windows.html">Windows</a></li><li><a href="/tutorials/clipboard.html">Clipboard</a></li><li><a href="/tutorials/drag-and-drop.html">Drag and Drop</a></li><li><a href="/tutorials/effects.html">Effects</a></li><li><a href="/tutorials/effects.transitions.html">Transitions</a></li><li><a href="/tutorials/data-binding.html">Data Binding</a></li><li><a href="/tutorials/property-binding.html">Property Binding</a></li><li><a href="/tutorials/localization.html">Localization</a></li><li><a href="/tutorials/background-tasks.html">Background Tasks</a></li><li><a href="/tutorials/web-queries.html">Web Queries</a></li><li><a href="/tutorials/query-servlet.html">QueryServlet</a></li><li><a href="/tutorials/scripting.html">Scripting</a></li><li><a href="/tutorials/summary.html">Summary</a></li><li><a href="/tutorials/stock-tracker.html">The "Stock Tracker" Application</a></li><li><a href="/tutorials/stock-tracker.ui.html">UI Markup Using BXML</a></li><li><a href="/tutorials/stock-tracker.events.html">Event Handling</a></li><li><a href="/tutorials/stock-tracker.web-queries.html">Web Queries</a></li><li><a href="/tutorials/stock-tracker.data-binding.html">Data Binding</a></li><li><a href="/tutorials/stock-tracker.localization.html">Localization</a></li><li><a href="/tutorials/bxml-primer.html">BXML Primer</a></li></ul><div class="content"><style type="text/css">
            applet {
                border: 1px solid #999999;
            }
        </style><!--NOTE: Syntax highlighting script is LGPL--><script type="text/javascript" src="http://alexgorbatchev.com/pub/sh/current/scripts/shCore.js"></script><script type="text/javascript" src="http://alexgorbatchev.com/pub/sh/current/scripts/shBrushJava.js"></script><script type="text/javascript" src="http://alexgorbatchev.com/pub/sh/current/scripts/shBrushXml.js"></script><script type="text/javascript" src="http://alexgorbatchev.com/pub/sh/current/scripts/shBrushJScript.js"></script><link type="text/css" rel="stylesheet" href="http://alexgorbatchev.com/pub/sh/current/styles/shCore.css"><link type="text/css" rel="stylesheet" href="http://alexgorbatchev.com/pub/sh/current/styles/shThemeDefault.css"><script type="text/javascript">
            SyntaxHighlighter.all();
        </script><div class="section">
        <p>
            Data binding is the process of automatically mapping values between a set of user
            interface elements and an internal data representation; for example, from a order entry
            form to a collection of database fields or vice versa. Data binding can help simplify
            development by eliminating some or all of the tedious boilerplate code that often goes
            along with this type of programming.
        </p>

        <p>
            In Pivot, data binding is controlled by the <tt>load()</tt> and <tt>store()</tt>
            methods of the <tt>Component</tt> class:
        </p>

        <p>
            <tt>public void load(Object context) {...}</tt><br>
            <tt>public void store(Object context) {...}</tt><br>
        </p>

        <p>
            The <tt>Object</tt> value passed to these methods provides the "bind context". It
            may be either an implementation of the <tt>org.apache.pivot.collections.Dictionary</tt>
            interface or a Java bean value that can be wrapped in an instance of
            <tt>org.apache.pivot.beans.BeanAdapter</tt>, which implements <tt>Dictionary</tt>.
        </p>

        <p>
            The bind context is essentially a collection of name/value pairs representing the data
            to which the components will be bound. Each bindable property of a component can be
            assigned a "bind key" that associates the property with a value in the context. Data is
            imported from the context into the property during a load, and exported from the
            property to the context during a store. Bind contexts may be flat or hierarchical;
            JSON path syntax can be used to retrieve nested values (e.g. "foo.bar.baz" or
            "foo['bar'].baz").
        </p>

        <p>
            Many Pivot components support data binding including text inputs, checkboxes and radio
            buttons, list views, and table views, among others. Some components support binding to
            multiple properties; for example, a caller can bind to both the list data as well as the
            selection state of a <tt>ListView</tt> component.
        </p>

        <h3>Data Binding in Stock Tracker</h3>

        <p>
            The Stock Tracker demo uses data binding to populate the fields in the quote detail
            view. The bind context is actually the row data retrieved from the web query for the
            selected stock. This is why the application requests more data than it seems to need
            from the GET query: the extra fields are used to fill in the data in the detail form.
        </p>

        <p>
            The bound components, in this case, are labels - Stock Tracker maps values from the
            retrieved quote data to the text property of each. The name of the key to use for each
            label is specified via the "textKey" property:
        </p>

        <pre class="brush:xml">
            
            &lt;Form styles="{padding:0, fill:true, showFlagIcons:false, showFlagHighlight:false,
                leftAlignLabels:true}"&gt;
                &lt;Form.Section&gt;
                    &lt;bxml:define&gt;
                        &lt;stocktracker:ValueMapping bxml:id="valueMapping"/&gt;
                        &lt;stocktracker:ChangeMapping bxml:id="changeMapping"/&gt;
                        &lt;stocktracker:VolumeMapping bxml:id="volumeMapping"/&gt;
                    &lt;/bxml:define&gt;

                    &lt;Label bxml:id="valueLabel" Form.label="%value"
                        textKey="value" textBindMapping="$valueMapping"
                        styles="{horizontalAlignment:'right'}"/&gt;
                    &lt;Label bxml:id="changeLabel" Form.label="%change"
                        textKey="change" textBindMapping="$changeMapping"
                        styles="{horizontalAlignment:'right'}"/&gt;
                    &lt;Label bxml:id="openingValueLabel" Form.label="%openingValue"
                        textKey="openingValue" textBindMapping="$valueMapping"
                        styles="{horizontalAlignment:'right'}"/&gt;
                    &lt;Label bxml:id="highValueLabel" Form.label="%highValue"
                        textKey="highValue" textBindMapping="$valueMapping"
                        styles="{horizontalAlignment:'right'}"/&gt;
                    &lt;Label bxml:id="lowValueLabel" Form.label="%lowValue"
                        textKey="lowValue" textBindMapping="$valueMapping"
                        styles="{horizontalAlignment:'right'}"/&gt;
                    &lt;Label bxml:id="volumeLabel" Form.label="%volume"
                        textKey="volume" textBindMapping="$volumeMapping"
                        styles="{horizontalAlignment:'right'}"/&gt;
                &lt;/Form.Section&gt;
            &lt;/Form&gt;
            
        </pre>

        <p>
            The actual binding occurs when the selection changes in the table view; the selection
            change handler calls the <tt>refreshDetail()</tt> method in response to a selection
            change event:
        </p>

        <pre class="brush:java">
            
            @SuppressWarnings("unchecked")
            private void refreshDetail() {
                StockQuote stockQuote = null;

                int firstSelectedIndex = stocksTableView.getFirstSelectedIndex();
                if (firstSelectedIndex != -1) {
                    int lastSelectedIndex = stocksTableView.getLastSelectedIndex();

                    if (firstSelectedIndex == lastSelectedIndex) {
                        List&lt;StockQuote&gt; tableData = (List&lt;StockQuote&gt;)stocksTableView.getTableData();
                        stockQuote = tableData.get(firstSelectedIndex);
                    } else {
                        stockQuote = new StockQuote();
                    }
                } else {
                    stockQuote = new StockQuote();
                }

                detailPane.load(new BeanAdapter(stockQuote));
            }
            
        </pre>

        <p>
            Note that the <tt>load()</tt> method is actually called on the detail pane itself
            rather than on the parent container of the detail labels (an instance of <tt>Form</tt>).
            This is because the application also needs to bind to the label that contains the
            company name, which is not a child of the <tt>Form</tt>:
        </p>

        <pre class="brush:xml">
            
            &lt;Label textKey="companyName" styles="{font:{size:12, bold:true}}"/&gt;
            
        </pre>

        <h3>Bind Mappings</h3>

        <p>
            Also note the use of the "textBindMapping" attributes. Bind mappings allow a caller
            to modify the data during the bind process. Incoming data can be converted before it
            is assigned to a property, and outgoing data can be converted before it is stored in
            the bind context. For example, the <tt>ValueMapping</tt> class formats incoming data
            as a currency value in U.S. dollars:
        </p>

        <pre class="brush:java">
            
            public class ValueMapping implements Label.TextBindMapping {
                private static final DecimalFormat FORMAT = new DecimalFormat("$0.00");

                @Override
                public String toString(Object value) {
                    return Float.isNaN((Float)value) ? null : FORMAT.format(value);
                }

                @Override
                public Object valueOf(String text) {
                    throw new UnsupportedOperationException();
                }
            }
            
        </pre>

        <p>
            The <tt>toString() method is called to perform the translation during a <tt>load()</tt>
            operation</tt>. The <tt>valueOf()</tt> method would be called during <tt>store()</tt>,
            but throws <tt>UnsupportedOperationException</tt> because <tt>store()</tt> is never
            called by the Stock Tracker application.
        </p>
    </div><p>Next: <a href="stock-tracker.localization.html">Localization</a></p></div></div></div><div id="footer" class="group"><div class="footerLogo">Copyright (c) 1999-2017<br>The Apache Software Foundation.</div><div class="footerLinks"><ul class="footerMenuGr"><li><strong>Demos</strong><ul><li><a href="/demos/kitchen-sink.html" target="_new">"Kitchen Sink"</a></li><li><a href="/demos/component-explorer.html" target="_new">Component Explorer</a></li><li><a href="http://cwiki.apache.org/confluence/display/PIVOT/Other+Demos" target="_new">Charting</a></li><li><a href="/demos/">More Demos</a></li></ul></li><li><strong>Documentation</strong><ul><li><a href="/getting-started.html">Getting Started</a></li><li><a href="/tutorials/">Tutorial</a></li><li><a href="/faq.html">FAQ</a></li><li><a href="/2.1.0/docs/api/">Javadoc (2.1.0)</a></li></ul></li><li><strong>Get Involved</strong><ul><li><a href="/svn.html">SVN Repositories</a></li><li><a href="/lists.html">Mailing Lists</a></li><li><a href="http://issues.apache.org/jira/browse/PIVOT">Bug Database</a></li><li><a href="http://cwiki.apache.org/PIVOT/">Wiki</a></li></ul></li><li><strong>Related</strong><ul><li><a href="http://code.google.com/a/apache-extras.org/p/pivot-jfree/">JFreeChart Provider</a></li><li><a href="http://code.google.com/a/apache-extras.org/p/pivot-common/">Pivot-Common</a></li><li><a href="http://code.google.com/a/apache-extras.org/p/pivot-contrib/">Pivot-Contrib</a></li><li><a href="http://code.google.com/a/apache-extras.org/p/pivot-multilang/">Pivot-Multilang</a></li><li><a href="http://code.google.com/a/apache-extras.org/p/pivot-stuff/">Pivot-Stuff</a></li></ul></li><li><strong>About</strong><ul><li><a href="/who-we-are.html">Who We Are</a></li><li><a href="/contact.html">Contact</a></li><li><a href="http://www.apache.org/">Apache Home</a></li><li><a href="/legal.html">Legal/License</a></li><li><a href="http://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li><li><a href="http://www.apache.org/foundation/thanks.html">Thanks</a></li></ul></li></ul></div><div class="footerLinks">
                    Apache Pivot, Pivot, Apache, and the Apache Pivot project logo are trademarks of The Apache Software Foundation.
                </div></div></div></body></html>