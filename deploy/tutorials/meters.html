<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--
Licensed to the Apache Software Foundation (ASF) under one or more
contributor license agreements.  See the NOTICE file distributed with
this work for additional information regarding copyright ownership.
The ASF licenses this file to you under the Apache License,
Version 2.0 (the "License"); you may not use this file except in
compliance with the License.  You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
--><html xmlns="http://www.w3.org/1999/xhtml"><head><meta content="text/html; charset=UTF-8" http-equiv="Content-Type" /><title>Meters | Apache Pivot</title><link xmlns="" type="text/css" rel="stylesheet" href="/~tvolkert/tmp/site/styles/pivot.css"><script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
                var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
                document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
                </script><script type="text/javascript">
                try {
                var pageTracker = _gat._getTracker("UA-7977275-3");
                pageTracker._trackPageview();
                } catch(err) {}</script></head><body><div xmlns="" id="wrapper"><div id="main"><div id="header"><div class="logo"><a href="/~tvolkert/tmp/site/index.html"><img title="Apache Pivot Homepage" alt="Apache Pivot" src="/~tvolkert/tmp/site/images/logo.png"></a></div><div class="tagline"><img alt="Rich Internet Applications (RIA) in Java (tm)" src="/~tvolkert/tmp/site/images/tagline.png"></div><ul class="navi"><li><a href="/~tvolkert/tmp/site/demos/">Demos</a></li><li><a href="/~tvolkert/tmp/site/download.cgi#1.4">Download</a></li><li><a href="/~tvolkert/tmp/site/documentation.html">Documentation</a></li><li><a href="/~tvolkert/tmp/site/get-involved.html">Get Involved</a></li><li><a href="/~tvolkert/tmp/site/about.html">About</a></li></ul></div><div class="group" id="contentBase"><h1>Meters</h1><ul class="naviLeft"><li><a href="/~tvolkert/tmp/site/tutorials/sample-application.html">Sample Application</a></li><li><a href="/~tvolkert/tmp/site/tutorials/platform-overview.html">Platform Overview</a></li><li><a href="/~tvolkert/tmp/site/tutorials/hello-world.html">Hello, World!</a></li><li><a href="/~tvolkert/tmp/site/tutorials/hello-wtkx.html">Hello, WTKX!</a></li><li><a href="/~tvolkert/tmp/site/tutorials/component-and-container.html">Component &amp; Container</a></li><li><a href="/~tvolkert/tmp/site/tutorials/labels-and-image-views.html">Labels &amp; Image Views</a></li><li><a href="/~tvolkert/tmp/site/tutorials/buttons.html">Buttons</a></li><li><a href="/~tvolkert/tmp/site/tutorials/push-buttons.html">Push Buttons</a></li><li><a href="/~tvolkert/tmp/site/tutorials/toggle-buttons.html">Toggle Buttons</a></li><li><a href="/~tvolkert/tmp/site/tutorials/radio-buttons.html">Radio Buttons</a></li><li><a href="/~tvolkert/tmp/site/tutorials/checkboxes.html">Checkboxes</a></li><li><a href="/~tvolkert/tmp/site/tutorials/link-buttons.html">Link Buttons</a></li><li><a href="/~tvolkert/tmp/site/tutorials/lists.html">Lists</a></li><li><a href="/~tvolkert/tmp/site/tutorials/list-buttons.html">List Buttons</a></li><li><a href="/~tvolkert/tmp/site/tutorials/text.html">Text</a></li><li><a href="/~tvolkert/tmp/site/tutorials/text-areas.html">Text Areas</a></li><li><a href="/~tvolkert/tmp/site/tutorials/separators.html">Separators</a></li><li><a href="/~tvolkert/tmp/site/tutorials/layout-containers.html">Layout Containers</a></li><li><a href="/~tvolkert/tmp/site/tutorials/flow-panes.html">Flow Panes</a></li><li><a href="/~tvolkert/tmp/site/tutorials/box-panes.html">Box Panes</a></li><li><a href="/~tvolkert/tmp/site/tutorials/grid-panes.html">Grid Panes</a></li><li><a href="/~tvolkert/tmp/site/tutorials/table-panes.html">Table Panes</a></li><li><a href="/~tvolkert/tmp/site/tutorials/borders.html">Borders</a></li><li><a href="/~tvolkert/tmp/site/tutorials/stack-panes.html">Stack Panes</a></li><li><a href="/~tvolkert/tmp/site/tutorials/split-panes.html">Split Panes</a></li><li><a href="/~tvolkert/tmp/site/tutorials/forms.html">Forms</a></li><li><a href="/~tvolkert/tmp/site/tutorials/panels.html">Panels</a></li><li><a href="/~tvolkert/tmp/site/tutorials/navigation-containers.html">Navigation Containers</a></li><li><a href="/~tvolkert/tmp/site/tutorials/card-panes.html">Card Panes</a></li><li><a href="/~tvolkert/tmp/site/tutorials/tab-panes.html">Tab Panes</a></li><li><a href="/~tvolkert/tmp/site/tutorials/accordions.html">Accordions</a></li><li><a href="/~tvolkert/tmp/site/tutorials/expanders.html">Expanders</a></li><li><a href="/~tvolkert/tmp/site/tutorials/rollups.html">Rollups</a></li><li><a href="/~tvolkert/tmp/site/tutorials/viewports.html">Viewports</a></li><li><a href="/~tvolkert/tmp/site/tutorials/scroll-panes.html">Scroll Panes</a></li><li><a href="/~tvolkert/tmp/site/tutorials/panoramas.html">Panoramas</a></li><li><a href="/~tvolkert/tmp/site/tutorials/progress-indicators.html">Progress Indicators</a></li><li><a href="/~tvolkert/tmp/site/tutorials/meters.html">Meters</a></li><li><a href="/~tvolkert/tmp/site/tutorials/activity-indicators.html">Activity Indicators</a></li><li><a href="/~tvolkert/tmp/site/tutorials/bounded-range-components.html">Bounded Range Components</a></li><li><a href="/~tvolkert/tmp/site/tutorials/sliders.html">Sliders</a></li><li><a href="/~tvolkert/tmp/site/tutorials/scroll-bars.html">Scroll Bars</a></li><li><a href="/~tvolkert/tmp/site/tutorials/spinners.html">Spinners</a></li><li><a href="/~tvolkert/tmp/site/tutorials/calendars.html">Calendars</a></li><li><a href="/~tvolkert/tmp/site/tutorials/menus.html">Menus</a></li><li><a href="/~tvolkert/tmp/site/tutorials/context-menus.html">Context Menus</a></li><li><a href="/~tvolkert/tmp/site/tutorials/menu-bars.html">Menu Bars</a></li><li><a href="/~tvolkert/tmp/site/tutorials/menu-buttons.html">Menu Buttons</a></li><li><a href="/~tvolkert/tmp/site/tutorials/color-choosers.html">Color Choosers</a></li><li><a href="/~tvolkert/tmp/site/tutorials/table-views.html">Table Views</a></li><li><a href="/~tvolkert/tmp/site/tutorials/table-views.json.html">JSON-based TableView</a></li><li><a href="/~tvolkert/tmp/site/tutorials/table-views.custom.html">Custom TableView</a></li><li><a href="/~tvolkert/tmp/site/tutorials/tree-views.html">Tree Views</a></li><li><a href="/~tvolkert/tmp/site/tutorials/file-browsing.html">File Browsing</a></li><li><a href="/~tvolkert/tmp/site/tutorials/windows.html">Windows</a></li><li><a href="/~tvolkert/tmp/site/tutorials/clipboard.html">Clipboard</a></li><li><a href="/~tvolkert/tmp/site/tutorials/drag-and-drop.html">Drag and Drop</a></li><li><a href="/~tvolkert/tmp/site/tutorials/drawing.html">Drawing</a></li><li><a href="/~tvolkert/tmp/site/tutorials/effects.html">Effects</a></li><li><a href="/~tvolkert/tmp/site/tutorials/effects.transitions.html">Transitions</a></li><li><a href="/~tvolkert/tmp/site/tutorials/background-tasks.html">Background Tasks</a></li><li><a href="/~tvolkert/tmp/site/tutorials/web-queries.html">Web Queries</a></li><li><a href="/~tvolkert/tmp/site/tutorials/data-binding.html">Data Binding</a></li><li><a href="/~tvolkert/tmp/site/tutorials/localization.html">Localization</a></li><li><a href="/~tvolkert/tmp/site/tutorials/scripting.html">Scripting</a></li><li><a href="/~tvolkert/tmp/site/tutorials/summary.html">Summary</a></li><li><a href="/~tvolkert/tmp/site/tutorials/stock-tracker.html">The "Stock Tracker" Application</a></li><li><a href="/~tvolkert/tmp/site/tutorials/stock-tracker.ui.html">UI Markup Using WTKX</a></li><li><a href="/~tvolkert/tmp/site/tutorials/stock-tracker.events.html">Event Handling</a></li><li><a href="/~tvolkert/tmp/site/tutorials/stock-tracker.web-queries.html">Web Queries</a></li><li><a href="/~tvolkert/tmp/site/tutorials/stock-tracker.data-binding.html">Data Binding</a></li><li><a href="/~tvolkert/tmp/site/tutorials/stock-tracker.localization.html">Localization</a></li><li><a href="/~tvolkert/tmp/site/tutorials/wtkx-primer.html">WTKX Primer</a></li></ul><div class="content"><!--NOTE: Syntax highlighting script is LGPL--><script src="http://alexgorbatchev.com/pub/sh/current/scripts/shCore.js" type="text/javascript"></script><script src="http://alexgorbatchev.com/pub/sh/current/scripts/shBrushJava.js" type="text/javascript"></script><script src="http://alexgorbatchev.com/pub/sh/current/scripts/shBrushXml.js" type="text/javascript"></script><script src="http://alexgorbatchev.com/pub/sh/current/scripts/shBrushJScript.js" type="text/javascript"></script><link href="http://alexgorbatchev.com/pub/sh/current/styles/shCore.css" rel="stylesheet" type="text/css"><link href="http://alexgorbatchev.com/pub/sh/current/styles/shThemeDefault.css" rel="stylesheet" type="text/css"><script type="text/javascript">
            SyntaxHighlighter.all();
        </script>
        <p>
            Meters are used to report progress to the user, generally the completion percentage of
            a background task such as a file load operation. An example is shown below. Clicking
            the Start button initiates a background task that simulates a long-running operation.
            Periodically, the task updates the meter to reflect its progress:
        </p>

        <script src="http://java.com/js/deployJava.js" type="text/javascript"></script><script type="text/javascript">
            
            var attributes = {
                code:"org.apache.pivot.wtk.BrowserApplicationContext$HostApplet",
                width:"300",
                height:"100"
            };

            
            

            
            var libraries = [];
            libraries.push("/~tvolkert/tmp/site/lib/pivot-core-1.4.jar");
                libraries.push("/~tvolkert/tmp/site/lib/pivot-wtk-1.4.jar");
                libraries.push("/~tvolkert/tmp/site/lib/pivot-wtk-terra-1.4.jar");
                libraries.push("/~tvolkert/tmp/site/lib/pivot-tutorials-1.4.jar");
                
            attributes.archive = libraries.join(",");

            
            var parameters = {
                codebase_lookup:false,
                java_arguments:"-Dsun.awt.noerasebackground=true -Dsun.awt.erasebackgroundonresize=true",
                application_class_name:"org.apache.pivot.tutorials.progress.Meters"
            };

            
            

            deployJava.runApplet(attributes, parameters, "1.6");
        </script>

        <p>
            The WTKX source for the example is shown below:
        </p>

        <pre class="brush:xml">
            
            &lt;Window title="Meters" maximized="true"
                xmlns:wtkx="http://pivot.apache.org/wtkx"
                xmlns="org.apache.pivot.wtk"&gt;
                &lt;content&gt;
                    &lt;TablePane&gt;
                        &lt;columns&gt;
                            &lt;TablePane.Column width="1*"/&gt;
                        &lt;/columns&gt;
                        &lt;rows&gt;
                            &lt;TablePane.Row height="1*"&gt;
                                &lt;Border styles="{padding:2}"&gt;
                                    &lt;content&gt;
                                        &lt;BoxPane styles="{horizontalAlignment:'center', verticalAlignment:'center'}"&gt;
                                            &lt;Label text="Progress:"/&gt;
                                            &lt;Meter wtkx:id="meter" preferredWidth="200" preferredHeight="16"/&gt;
                                        &lt;/BoxPane&gt;
                                    &lt;/content&gt;
                                &lt;/Border&gt;
                            &lt;/TablePane.Row&gt;
                            &lt;TablePane.Row height="-1"&gt;
                                &lt;BoxPane styles="{horizontalAlignment:'center', padding:6}"&gt;
                                    &lt;PushButton wtkx:id="progressButton" styles="{minimumAspectRatio:3}"/&gt;
                                &lt;/BoxPane&gt;
                            &lt;/TablePane.Row&gt;
                        &lt;/rows&gt;
                    &lt;/TablePane&gt;
                &lt;/content&gt;
            &lt;/Window&gt;
            
        </pre>

        <p>
            The Java source is as follows. The main application class defines an inner class that
            extends the <tt>pivot.util.concurrent.Task</tt> class to simulate a background
            operation. This task simply sleeps for 100ms at a time and updates the meter when it
            wakes up to reflect the current count. Since all UI updates must be performed on the
            UI thread, the task queues a callback to set the meter's percent complete; a
            <tt>pivot.wtk.TaskAdapter</tt> is used to process the task notifications for the same
            reason:
        </p>

        <pre class="brush:java">
            
            package org.apache.pivot.tutorials.progress;

            import org.apache.pivot.collections.Map;
            import org.apache.pivot.util.concurrent.Task;
            import org.apache.pivot.util.concurrent.TaskExecutionException;
            import org.apache.pivot.util.concurrent.TaskListener;
            import org.apache.pivot.wtk.Application;
            import org.apache.pivot.wtk.ApplicationContext;
            import org.apache.pivot.wtk.Button;
            import org.apache.pivot.wtk.ButtonPressListener;
            import org.apache.pivot.wtk.DesktopApplicationContext;
            import org.apache.pivot.wtk.Display;
            import org.apache.pivot.wtk.Meter;
            import org.apache.pivot.wtk.PushButton;
            import org.apache.pivot.wtk.TaskAdapter;
            import org.apache.pivot.wtk.Window;
            import org.apache.pivot.wtkx.WTKXSerializer;

            public class Meters implements Application {
                public class SampleTask extends Task&lt;Void&gt; {
                    private int percentage = 0;

                    @Override
                    public Void execute() throws TaskExecutionException {
                        // Simulate a long-running operation
                        percentage = 0;

                        while (percentage &lt; 100
                            &amp;&amp; !abort) {
                            try {
                                Thread.sleep(100);
                                percentage++;

                                // Update the meter on the UI thread
                                ApplicationContext.queueCallback(new Runnable() {
                                    @Override
                                    public void run() {
                                        meter.setPercentage((double)percentage / 100);
                                    }
                                });
                            } catch(InterruptedException exception) {
                                throw new TaskExecutionException(exception);
                            }
                        }

                        return null;
                    }
                }

                private Window window = null;
                private Meter meter = null;
                private PushButton progressButton = null;

                private SampleTask sampleTask = null;

                @Override
                public void startup(Display display, Map&lt;String, String&gt; properties)
                    throws Exception {
                    WTKXSerializer wtkxSerializer = new WTKXSerializer();
                    window = (Window)wtkxSerializer.readObject(this, "meters.wtkx");
                    meter = (Meter)wtkxSerializer.get("meter");
                    progressButton = (PushButton)wtkxSerializer.get("progressButton");

                    progressButton.getButtonPressListeners().add(new ButtonPressListener() {
                        @Override
                        public void buttonPressed(Button button) {
                            if (sampleTask == null) {
                                // Create and start the simulated task; wrap it in a
                                // task adapter so the result handlers are called on the
                                // UI thread
                                sampleTask = new SampleTask();
                                sampleTask.execute(new TaskAdapter&lt;Void&gt;(new TaskListener&lt;Void&gt;() {
                                    @Override
                                    public void taskExecuted(Task&lt;Void&gt; task) {
                                        reset();
                                    }

                                    @Override
                                    public void executeFailed(Task&lt;Void&gt; task) {
                                        reset();
                                    }

                                    private void reset() {
                                        // Reset the meter and button
                                        sampleTask = null;
                                        meter.setPercentage(0);
                                        updateProgressButton();
                                    }
                                }));
                            } else {
                                // Cancel the task
                                sampleTask.abort();
                            }

                            updateProgressButton();
                        }
                    });

                    updateProgressButton();

                    window.open(display);
                }

                @Override
                public boolean shutdown(boolean optional) {
                    if (window != null) {
                        window.close();
                    }

                    return false;
                }

                @Override
                public void suspend() {
                }

                @Override
                public void resume() {
                }

                private void updateProgressButton() {
                    if (sampleTask == null) {
                        progressButton.setButtonData("Start");
                    } else {
                        progressButton.setButtonData("Cancel");
                    }
                }

                public static void main(String[] args) {
                    DesktopApplicationContext.main(Meters.class, args);
                }
            }
            
        </pre>
    <p>Next: <a href="activity-indicators.html">Activity Indicators</a></p></div></div></div><div class="group" id="footer"><div class="footerLogo">Copyright (c) 1999-2010<br>The Apache Software Foundation.</div><div class="footerLinks"><ul class="footerMenuGr"><li><strong>Demos</strong><ul><li><a href="/~tvolkert/tmp/site/demos/kitchen-sink.html" target="_new">"Kitchen Sink"</a></li><li><a href="/~tvolkert/tmp/site/demos/component-explorer.html" target="_new">Component Explorer</a></li><li><a href="http://ixnay.biz/charts.html" target="_new">Charting</a></li><li><a href="/~tvolkert/tmp/site/demos/">More Demos</a></li></ul></li><li><strong>Documentation</strong><ul><li><a href="/~tvolkert/tmp/site/getting-started.html">Getting Started</a></li><li><a href="/~tvolkert/tmp/site/tutorials/">Tutorial</a></li><li><a href="http://cwiki.apache.org/PIVOT/frequently-asked-questions-faq.html">FAQ</a></li><li><a href="/~tvolkert/tmp/site/1.4/docs/api/">Javadoc (1.4)</a></li></ul></li><li><strong>Get Involved</strong><ul><li><a href="/~tvolkert/tmp/site/svn.html">SVN Repositories</a></li><li><a href="/~tvolkert/tmp/site/lists.html">Mailing Lists</a></li><li><a href="http://issues.apache.org/jira/browse/PIVOT/">Bug Database</a></li><li><a href="http://cwiki.apache.org/PIVOT/">Wiki</a></li></ul></li><li><strong>Related</strong><ul><li><a href="http://code.google.com/p/pivot-jfree/">JFreeChart Provider</a></li></ul></li><li><strong>About</strong><ul><li><a href="/~tvolkert/tmp/site/who-we-are.html">Who We Are</a></li><li><a href="/~tvolkert/tmp/site/contact.html">Contact</a></li><li><a href="/~tvolkert/tmp/site/news.html">News</a></li><li><a href="/~tvolkert/tmp/site/legal.html">Legal/License</a></li></ul></li></ul></div></div></div></body></html>